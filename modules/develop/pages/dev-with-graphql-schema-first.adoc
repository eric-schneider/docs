= Developing with the {database} GraphQL API (Schema-first)
:keywords: database, GraphQL, api

include::partial$stargate-intro-intro.adoc[]

The GraphQL API modifies and queries your table data using GraphQL object types, queries, and mutations.

include::develop:partial$graphql-schema-first-desc.adoc[]

include::develop:partial$GQLAPIBlogPost.adoc[]

// tag::prereqsList[]
include::develop:partial$gql-prereqs.adoc[]
// end::prereqsList[]

// not in astra yet
//include::develop:partial$astra_tip.adoc[]

// tag::getDockerImage[]
include::develop:partial$docker_pull.adoc[tag=3x]
// end::getDockerImage[]

// tag::startDocker[]
include::develop:partial$docker_run.adoc[tag=3x_graphql-first]
// end::startDocker[]

// LLP: Consider making the oss and astra prereqs into develop:partial for all dev-with-*** files
// == Prerequisite
// * `cURL` to run REST queries

// // ASTRA
// ifdef::astra[]
// * If you haven't already, create a database using https://astra.datastax.com/[{database}].
// endif::[]

// ifdef:astra[]
// * Before you get started, set your environment variables to save time developing on your database.

// . In link:https://astra.datastax.com[{astra_db}, window="_blank"], select the database to which you want to connect.
// . In your *Database Dashboard*, select *Connect*.
// . Select *REST API*.
// +
// include::partial$note_multi-region_connect.adoc[]

// . Follow the steps in the prerequisites to get your xref:manage:org/managing-org.adoc#_manage_application_tokens[application token] and set up your environment variables.
// . In your command-line interface associated with your environment, paste the following environment variables copied for your {astra_db} database:

// [source, shell]
// ----
// export ASTRA_DB_ID=<database_id>
// export ASTRA_DB_REGION=<database_region>
// export ASTRA_DB_KEYSPACE=<keyspace_name>
// export ASTRA_DB_APPLICATION_TOKEN=<app_token>
// ----
// endif::[]

== About the GraphQL API endpoints

There are three {database} GraphQL API endpoints, one for creating schema in schema-first, one for deploying schema in the graphql-first, and the third for querying or mutating a keyspace. 
The URLS are:

Schema::
ifdef::astra[]
`{base_graphql_url}/api/graphql-schema`
endif::[]
ifdef::stargate[]
`{base_graphql_url}/graphql-schema`
endif::[]

Admin::
ifdef::astra[]
`{base_graphql_url}/api/graphql-admin`
endif::[]
ifdef::stargate[]
`{base_graphql_url}/graphql-admin`
endif::[]

Querying::
ifdef::astra[]
`{base_graphql_url}/api/graphql/{keyspace_name}`
endif::[]
ifdef::stargate[]
`{base_graphql_url}/graphql/{keyspace_name}`
endif::[]

The schema endpoint is used to create or alter CQL schema in the schema-first GraphQL using direct schema manipulation. 
The admin endpoint is used to deploy GraphQL schema in the graphql-first GraphQL which will indirectly modify underlying CQL schema. 
The querying endpoint is constructed in the same manner for both graphql-first and schema-first.

Each request must have a valid xref:manage:org/managing-org.adoc#_manage_application_tokens[application token].
Each request can also have an optional unique request id.
The request id is recommended in a production environment and can be useful in troubleshooting issues.

[TIP]
====
**Generating UUIDs**
Consider using a tool like this https://www.uuidgenerator.net/[online UUID generator, window="_blank"]
to quickly create a random UUID to pass with your requests if you are submitting
the queries manually using a tool like cURL.
====

include::develop:partial$GQLNaming.adoc[]

include::page$using-graphql-playground.adoc[]

include::page$tooling.adoc[Using Postman as a tool, tag=using-postman]

// LLP 12.21.21 NEED TO SORT OUT AUTH/APP TOKEN FOR STARGATE AND ASTRA
// SUSPECT THAT manage will be sg in sg docs, and astra in astra-docs

include::page$manage/manage-application-tokens.adoc[Get an application token]

ifdef::stargate[]
include::develop:page$api-graphql-schema-first/gqlsf-creating-keyspace.adoc[Creating keyspace schema]
endif::[]

//include::develop:page$api-graphql-schema-first/gql-checking-keyspace.adoc[Checking keyspace schema]

ifdef::stargate[]
include::develop:page$api-graphql-schema-first/gqlsf-deleting-keyspace.adoc[Dropping keyspace schema]
endif::[]

include::develop:page$api-graphql-schema-first/gqlsf-schema-data-types.adoc[Schema and data types]

include::develop:page$api-graphql-schema-first/gqlsf-creating-object-types.adoc[Creating object types]

// include::develop:page$api-graphql-schema-first/gql-dropping-table.adoc[Dropping table schema]

include::develop:page$api-graphql-schema-first/gqlsf-creating-index.adoc[Creating an index]

// include::develop:page$api-graphql-schema-first/gql-deleting-index.adoc[Deleting an index]

include::develop:page$api-graphql-schema-first/gqlsf-creating-udt.adoc[Creating a user-defined type (UDT)]

// include::develop:page$api-graphql-schema-first/gql-dropping-udt.adoc[Dropping a user-defined type (UDT)]

include::develop:page$api-graphql-schema-first/gqlsf-creating-queries.adoc[Creating queries]

include::develop:page$api-graphql-schema-first/gqlsf-creating-mutations.adoc[Creating mutations]

include::develop:page$api-graphql-schema-first/gqlsf-creating-payload-types.adoc[Creating payload types]

include::develop:page$api-graphql-schema-first/gqlsf-deploying-schema.adoc[Deploying schema]

include::develop:page$api-graphql-schema-first/gqlsf-checking-keyspace-schema.adoc[Checking schema]

include::develop:page$api-graphql-schema-first/gqlsf-undeploying-schema.adoc[Undeploying schema]

include::develop:page$api-graphql-schema-first/gqlsf-writing-data.adoc[Writing data]

include::develop:page$api-graphql-schema-first/gqlsf-reading-data.adoc[Reading data]

include::develop:page$api-graphql-schema-first/gqlsf-updating-data.adoc[Updating data]

include::develop:page$api-graphql-schema-first/gqlsf-deleting-data.adoc[Deleting data]

include::develop:page$api-graphql-schema-first/gqlsf-directives.adoc[Directives]

